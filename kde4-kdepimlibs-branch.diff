Index: kimap/sessionthread.cpp
===================================================================
--- kimap/sessionthread.cpp	(.../tags/KDE/4.5.1/kdepimlibs)	(wersja 1170567)
+++ kimap/sessionthread.cpp	(.../branches/KDE/4.5/kdepimlibs)	(wersja 1170567)
@@ -49,7 +49,10 @@
 {
   // don't call quit() directly, this will deadlock in wait() if exec() hasn't run yet
   QMetaObject::invokeMethod( this, "quit" );
-  wait();
+  if ( !wait( 10 * 1000 ) ) {
+    kWarning() << "Session thread refuses to die, killing harder...";
+    terminate();
+  }
 }
 
 void SessionThread::sendData( const QByteArray &payload )
Index: kmime/kmime_content.cpp
===================================================================
--- kmime/kmime_content.cpp	(.../tags/KDE/4.5.1/kdepimlibs)	(wersja 1170567)
+++ kmime/kmime_content.cpp	(.../branches/KDE/4.5/kdepimlibs)	(wersja 1170567)
@@ -513,7 +513,6 @@
         // Add to new content.
         main->setHeader( *it );
         // Remove from this content.
-        delete (*it);
         it = h_eaders.erase( it );
       } else {
         ++it;
@@ -576,7 +575,6 @@
     foreach( Headers::Base *h, main->h_eaders ) {
       setHeader( h ); // Will remove the old one if present.
     }
-    qDeleteAll( main->h_eaders );
     main->h_eaders.clear();
 
     // Move the body.

Zmiany atrybut√≥w dla: .
___________________________________________________________________
Zmienione: svnmerge-integrated
   - /branches/kdepim/enterprise4/kdepimlibs:1-809779,809854-813579,813581-813598,813600-821927,822131,823512,823589,824206,824213,824895,831358,834955-835617,837809,843671,844028,844044,850305,852197,853294,853770,854349,854627,856353,856699,856996,859216,861651,861668,863904-863910,874469,875493,877777,881490,883237,883308,883317,883319,883322,883324,883327,900447,915152-915164,918707,921740,931414,931427,937851,937906-938266,938268-938271,938273-938278,938281-940157,941295,944957,947276,948737,950530,951162,961006-961007,961567,962326,962328,965363,967747,969620,970460-970465,970468,974183,977548-979665,979667-980927,980929-982939,982941-982947,982949-982950,982953-982954,982956-983182,983184-983186,983188-986158,986160-989638,989925-990097,990099-990113,992544,993922,994464,994512,999727,999889,1001119,1001354,1001591,1001919,1003652,1003683,1004162,1004200-1004627,1006338,1006407,1006811,1007376,1008464,1009689,1009786,1010097,1010408,1010804,1010837,1012351,1012416,1012629,1013745-1013757,1015161,1015463,1020958,1022132,1022145,1022367,1023349,1023454,1023981,1026836,1029015,1038909-1038911,1040719,1040870,1041824,1042271,1042721,1042766,1047215,1055387,1057460,1058343,1058473,1060332,1062466,1063997,1065143,1066072-1066387,1066389-1067091,1067813,1067894,1067916,1071151,1071166,1072577,1073312,1090463,1090554,1090577,1102530-1102531 /branches/work/akonadi-ports/kdepimlibs:1-982692,983264,983691-986698,986700-987562,987564-994694,994696-994808,994810-994820,994822-995232,995234-995396,995398-995404,995406-995798,995800-997744,997746-1006186,1006188-1006193,1006196-1007211,1007213,1007215-1007217,1007219-1007231,1007233-1010098,1010100-1012993,1012995-1013019,1013021-1023684,1029746-1029748,1030617-1030629,1031955-1073464,1073635-1073636,1074770 /trunk/KDE/kdepimlibs:1-1143426,1149395,1154892,1161656,1163117
   + /branches/kdepim/enterprise4/kdepimlibs:1-809779,809854-813579,813581-813598,813600-821927,822131,823512,823589,824206,824213,824895,831358,834955-835617,837809,843671,844028,844044,850305,852197,853294,853770,854349,854627,856353,856699,856996,859216,861651,861668,863904-863910,874469,875493,877777,881490,883237,883308,883317,883319,883322,883324,883327,900447,915152-915164,918707,921740,931414,931427,937851,937906-938266,938268-938271,938273-938278,938281-940157,941295,944957,947276,948737,950530,951162,961006-961007,961567,962326,962328,965363,967747,969620,970460-970465,970468,974183,977548-979665,979667-980927,980929-982939,982941-982947,982949-982950,982953-982954,982956-983182,983184-983186,983188-986158,986160-989638,989925-990097,990099-990113,992544,993922,994464,994512,999727,999889,1001119,1001354,1001591,1001919,1003652,1003683,1004162,1004200-1004627,1006338,1006407,1006811,1007376,1008464,1009689,1009786,1010097,1010408,1010804,1010837,1012351,1012416,1012629,1013745-1013757,1015161,1015463,1020958,1022132,1022145,1022367,1023349,1023454,1023981,1026836,1029015,1038909-1038911,1040719,1040870,1041824,1042271,1042721,1042766,1047215,1055387,1057460,1058343,1058473,1060332,1062466,1063997,1065143,1066072-1066387,1066389-1067091,1067813,1067894,1067916,1071151,1071166,1072577,1073312,1090463,1090554,1090577,1102530-1102531 /branches/work/akonadi-ports/kdepimlibs:1-982692,983264,983691-986698,986700-987562,987564-994694,994696-994808,994810-994820,994822-995232,995234-995396,995398-995404,995406-995798,995800-997744,997746-1006186,1006188-1006193,1006196-1007211,1007213,1007215-1007217,1007219-1007231,1007233-1010098,1010100-1012993,1012995-1013019,1013021-1023684,1029746-1029748,1030617-1030629,1031955-1073464,1073635-1073636,1074770 /trunk/KDE/kdepimlibs:1-1143426,1149395,1154892,1161656,1163117,1166311,1168823

